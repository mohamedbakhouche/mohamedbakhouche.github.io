<!DOCTYPE html>
<html lang="en">
	<head>
		<title>three.js webgl - glTF loader</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link rel="stylesheet" href="style.css">
	</head>

	<body>
		<div id="view">
					
			<!-- <div class="btn">
				<p class="c-btn" alt="alt-btn">material</p>
			</div> -->
			<form id="leves">
				
				toit<input  class="raduis-btn" type="radio" name="radio" checked>
				<span class="circle" id="roof-btn" alt="alt-btn"></span><br>

				3eme<input  class="raduis-btn" type="radio" name="radio" >
				<span class="circle" id="three-btn" alt="alt-btn"></span><br>

				2eme<input  class="raduis-btn" type="radio" name="radio" >
				<span class="circle" id="tow-btn" alt="alt-btn"></span><br>

				1er&nbsp<input  class="raduis-btn" type="radio" name="radio" >
				<span class="circle" id="one-btn" alt="alt-btn"></span><br>

				RDC&nbsp<input  class="raduis-btn" type="radio" name="radio" >
				<span class="circle" id="rdc-btn" alt="alt-btn"></span><br>
				<span class="circle-line"></span>
				
			</form>
			<div id="side-menu" >
					<div id="menu-icon">
						<span></span>
						<span></span>
						<span></span>
					</div>
						<div class="scroll" id="sidebar">
							<h3>Images</h3>
							<ul>
								<img class="menu-img1" src="icon/leman.jpg" alt="">
								<img class="menu-img1" src="icon/leman1.jpg" alt="">
								<img class="menu-img1" src="icon/leman1.jpg" alt="">
							</ul>
						</div>
			</div>
			<div class="sun-slider">
				<input type="range" value="0" min="0" max="100" class="sun-range" id="sun-slid">

			</div>
			
		</div>

		<script
 		src="https://code.jquery.com/jquery-3.3.1.min.js"
  		integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  		crossorigin="anonymous"></script>
		<script src="build/three.min.js"></script>
		<script src="build/OrbitControls.js"></script>
		<script src="build/GLTFLoader.js"></script>

		<script>
			$(document).ready(function()
			{
					$('#menu-icon').click(function()
					{
						$('#side-menu').toggleClass('visible');
					});
			});
		</script>
				
		<script>
		
			var w = window.innerWidth;
			var h = window.innerHeight;
			var container, controls;
			var camera, scene, renderer, light;
			var mesh;
			var dirLight

			var mouse = new THREE.Vector2(), INTERSECTED;
			var raycaster = new THREE.Raycaster();

			init();
			
			function init() {
				
				var loader = new THREE.GLTFLoader();
				
				container = document.getElementById( 'view' );
				document.body.appendChild( container );

				var info = document.createElement( 'div' );
				info.style.position = 'absolute';
				info.style.top = '10px';
				info.style.width = '100%';
				info.style.textAlign = 'center';
				info.innerHTML = 'Drag to spin the model';
				container.appendChild( info );

				camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 0.25, 200 );
				camera.position.set( -50.0, 20.0, 30.0 );
				

				renderer = new THREE.WebGLRenderer( { antialias: true, alpha: true,} );
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth, window.innerHeight );
				renderer.gammaOutput = true;
				renderer.gammaInput = true;
				
				renderer.shadowMap.enabled = true;


				controls = new THREE.OrbitControls( camera , renderer.domElement);
				controls.enablePan = false;
				controls.target.set( 0, -0.0, -0.0 );
				controls.minDistance = 30;
				controls.maxDistance = 100;
				// console.log(controls);

				controls.maxPolarAngle = Math.PI / 2;
				// controls.update();

				loader.load( 'model/test2.gltf', function ( gltf ) 
				{
					scene = gltf.scene ;

					var path = 'Bridge2/';
					var format = '.jpg';
					var envMap = new THREE.CubeTextureLoader().load( [
					path + 'front' + format, path + 'back' + format,
					path + 'top' + format, path + 'down' + format,
					path + 'left' + format, path + 'right' + format
					] );
					scene.background = envMap;
					envMap.format = THREE.RGBFormat;

					var loader = new THREE.TextureLoader();
    				var BG = loader.load( 'icon/bg02.jpg' );
					scene.background = BG;

					// var bleuSkyColor = new THREE.Color("rgb(135, 206, 235)");
					// var brColor = new THREE.Color("rgb(204, 230, 230)");
					// light = new THREE.HemisphereLight( bleuSkyColor, brColor, 0.5 );
					// light.position.set( 0, 1, 0 );
					// scene.add( light ); 

					var hemiLight = new THREE.HemisphereLight( 0xffffff, 0xffffff, 0.6 );
					hemiLight.color.setHSL( 0.6, 1, 0.6 );
					hemiLight.groundColor.setHSL( 0.095, 1, 0.75 );
					hemiLight.position.set( 0, 50, 0 );
					scene.add( hemiLight );
					// var hemiLightHelper = new THREE.HemisphereLightHelper( hemiLight, 10 );
					// scene.add( hemiLightHelper );
					//
					dirLight = new THREE.DirectionalLight( 0xffffff, 1 );
					dirLight.color.setHSL( 0.1, 1, 0.95 );
					dirLight.position.set( -60, 40, 26 );
					// dirLight.position.multiplyScalar( 30 );
					scene.add( dirLight );
					dirLight.castShadow = true;
					dirLight.shadow.mapSize.width = 2048;
					dirLight.shadow.mapSize.height = 2048;
					var d = 20;
					dirLight.shadow.camera.left = -d;
					dirLight.shadow.camera.right = d;
					dirLight.shadow.camera.top = d;
					dirLight.shadow.camera.bottom = -d;
					dirLight.shadow.camera.far = 350;
					dirLight.shadow.bias = 0.00;
					var dirLightHeper = new THREE.DirectionalLightHelper( dirLight, 10 );
					// scene.add( dirLightHeper );

					
					
					// $('#sun-slid').change( function(){
					// 	var val = $('#sun-slid').val();
					// 	console.log(val);
					// 	dirLight.position.set( -val -20, 40, val );
					// }); 

					scene.traverse( function ( node ) 
					{
						if ( node.isMesh ) {
							node.castShadow = true;
							// console.log(node);
							node.receiveShadow = true;

					 		if ( node.material )
							 {
					 			node.material.envMap = envMap;
					 			node.material.needsUpdate = true;
								
					 		} 
						}
					});

					var RDC = scene.getObjectByName("RDC");
					var oneEr = scene.getObjectByName("1er");
					var towEme = scene.getObjectByName("2eme");
					var threEme = scene.getObjectByName("3eme");
					var toit = scene.getObjectByName("toit");
					
					// console.log(RDC.material);

					$('#rdc-btn').click( function(){
					var rdc = $(this).attr('alt');
					if(rdc){
						oneEr.visible = false;
						towEme.visible = false;
						threEme.visible = false;
						toit.visible = false;
						// var roughnessMap = mat.roughnessMap.image;
						// var roughness = mat.roughnessMap;
						// switch(RDC.visible){
						// 	case false:
						// 	RDC.visible = true; break;
						// 	case true:
						// 	RDC.visible = false; break;
						// }
						}
					});
					$('#one-btn').click( function(){
					var ONE = $(this).attr('alt');
					if(ONE){
						towEme.visible = false;
						threEme.visible = false;
						toit.visible = false;

						RDC.visible = true;
						oneEr.visible = true;
						}
					});
					$('#tow-btn').click( function(){
					var TOW = $(this).attr('alt');
					if(TOW){
						threEme.visible = false;
						toit.visible = false;

						RDC.visible = true;
						oneEr.visible = true;
						towEme.visible = true;
						}
					});
					$('#three-btn').click( function(){
					var THREE = $(this).attr('alt');
					if(THREE){
						RDC.visible = true;
						oneEr.visible = true;
						towEme.visible = true;
						threEme.visible = true;
						toit.visible = false;
						}
					});
					$('#roof-btn').click( function(){
					var THREE = $(this).attr('alt');
					if(THREE){
						RDC.visible = true;
						oneEr.visible = true;
						towEme.visible = true;
						threEme.visible = true;
						toit.visible = true;
						}
					}); 

				} );

				
				

				container.appendChild( renderer.domElement );
				window.addEventListener( 'resize', onWindowResize, true );
				// document.addEventListener( "click", onMouseMove, false );
			}
			
			function onWindowResize() {
				camera.aspect = (window.innerWidth/2) / (window.innerHeight/2);
				camera.updateProjectionMatrix();
				renderer.setSize( window.innerWidth, window.innerHeight );
				// controls.handleResize();
			}

			// function onMouseMove( event ) {
				
			// 	event.preventDefault();
			// 	mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
			// 	mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;

			// 	raycaster.setFromCamera( mouse, camera );
				
			// 	var obj = scene.getObjectByName("RDC"); 
			// 	var chil = scene.children[0];
			// 	console.log(chil.children);
			// 	var chilt = chil.children;
			// 	var intersects = raycaster.intersectObjects(obj.children);
			// 	// Toggle rotation bool for meshes that we clicked
			// 	if ( intersects.length > 0 ) {
			// 		console.log("cast");
			// 	}
			// }
			function render(){
				
				renderer.render( scene, camera );
				
			}

			animate();
		
			function animate() {
				var changeSun = document.getElementById('sun-slid');
					changeSun.addEventListener('input', function(){
						dirLight.position.set( -60 , 40, this.value );
						
					},false);
				requestAnimationFrame( animate );
				
				render();
			}
		</script>
	</body>
</html>